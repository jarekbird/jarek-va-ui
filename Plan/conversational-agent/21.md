# Add ElevenLabs API Client to Frontend

## Scope
`jarek-va-ui`.

## Subtasks
- Create `src/api/elevenlabs.ts` with:
  - `getVoiceSignedUrl(agentId?: string)`.
  - `registerSession(conversationId, sessionData)`.
- Use `VITE_ELEVENLABS_AGENT_URL` as base.
- Provide clear error messages and type definitions.
- Add unit tests (mocking HTTP) for `getVoiceSignedUrl` and `registerSession` success and failure paths.

## Desired Outcomes

### Primary Outcomes
1. **API Client**: Typed functions for interacting with elevenlabs-agent service from the frontend.

2. **Signed URL Support**: Function to fetch signed URLs for private agent connections.

3. **Session Registration**: Function to register active sessions with the backend for callback routing.

4. **Error Handling**: User-friendly error messages and proper error types.

5. **Type Safety**: Full TypeScript integration with proper types.

### Success Criteria
- Both functions implemented and tested
- Proper error handling
- TypeScript types defined
- Base URL configurable
- Clear error messages
- Tests cover success and failure paths
- Follows patterns from other API modules

## User Stories

### As a Developer
- **Story 1**: I want typed API functions so that I can easily call the elevenlabs-agent service.
- **Story 2**: I want clear error handling so that I can provide good UX when things fail.

### As a User
- **Story 3**: I want clear error messages so that I understand when something goes wrong.

## Suggested Automated Tests

### Unit Tests
1. **Success Path Tests**:
   ```typescript
   describe('ElevenLabs API Client', () => {
     it('fetches signed URL', async () => {
       mockFetch.mockResolvedValue({
         ok: true,
         json: async () => ({ signedUrl: 'wss://...', expiresAt: '...' })
       });
       
       const result = await getVoiceSignedUrl('agent-123');
       expect(result.signedUrl).toBeDefined();
     });
     
     it('registers session', async () => {
       mockFetch.mockResolvedValue({
         ok: true,
         json: async () => ({ success: true })
       });
       
       const result = await registerSession('conv-123', {
         sessionUrl: 'wss://...'
       });
       expect(result.success).toBe(true);
     });
   });
   ```

2. **Error Handling Tests**:
   ```typescript
   describe('Error Handling', () => {
     it('handles network errors', async () => {
       mockFetch.mockRejectedValue(new Error('Network error'));
       await expect(getVoiceSignedUrl()).rejects.toThrow();
     });
     
     it('handles 500 errors', async () => {
       mockFetch.mockResolvedValue({ ok: false, status: 500 });
       await expect(getVoiceSignedUrl()).rejects.toThrow();
     });
   });
   ```

## Inherent Risks

### Medium Risk
1. **API Contract Mismatch**:
   - **Risk**: Frontend expects different structure than backend provides
   - **Mitigation**: Coordinate with backend, validate responses, type safety

2. **Base URL Misconfiguration**:
   - **Risk**: Wrong base URL causing API calls to fail
   - **Mitigation**: Environment variable validation, clear documentation, defaults

### Low Risk
3. **Error Message Quality**:
   - **Risk**: Technical error messages confusing users
   - **Mitigation**: User-friendly messages, error translation, UX review
