# TASK-TD-003: Survey Backend Contracts Needed for Task Dashboard

**Section**: 2. Backend Contract Discovery
**Subsection**: 2.1
**Task ID**: TASK-TD-003
**Order**: 003

## Description

This task involves identifying and documenting all backend API endpoints required by the Task Dashboard. The goal is to create a comprehensive inventory of required endpoints, their request/response shapes, and identify any gaps that need to be addressed in the `cursor-executor` backend before the frontend can be fully implemented.

**Reference Implementation**: 
- `python-cursor/cursor-executor/cursor-executor-back/` (backend codebase)
- `python-cursor/cursor-executor/cursor-executor-front/src/api/` (existing API clients)

## Current State

- `cursor-executor-front` has existing API clients for conversations (`src/api/conversations.ts`)
- Tasks API client exists but is a placeholder (`src/api/tasks.ts` throws errors)
- No API client exists for working directory files
- No API client exists for queue/worker status
- Backend endpoints may or may not exist for all required functionality
- Documentation may exist in `docs/conversation-task-api.md` or similar

**Important**: This task focuses on discovery and documentation. Implementation of missing endpoints is out of scope for this task (will be separate backend tasks).

## Checklist

### Preparation and Setup

- [ ] Navigate to `python-cursor/cursor-executor/cursor-executor-back/` directory
- [ ] Review backend codebase structure
- [ ] Identify API route definitions (FastAPI routes, Flask routes, etc.)
- [ ] Review existing API documentation (if any)
- [ ] Review `cursor-executor-front/src/api/` to understand current API contracts

### Implementation Steps

- [ ] Step 1: Inventory conversations and messages endpoints
  - [ ] Review existing `src/api/conversations.ts` in frontend
  - [ ] Identify backend endpoints used:
    - [ ] List conversations endpoint
    - [ ] Get single conversation endpoint
  - [ ] Check if endpoints exist for:
    - [ ] Creating new conversations
    - [ ] Adding messages to conversations
    - [ ] Updating conversations
  - [ ] Document endpoint paths, methods, request shapes, response shapes
  - [ ] Note any missing endpoints needed for NoteTakingPanel
- [ ] Step 2: Inventory tasks endpoints
  - [ ] Review existing `src/api/tasks.ts` in frontend (placeholder)
  - [ ] Search backend codebase for task-related endpoints
  - [ ] Identify or document required endpoints:
    - [ ] List tasks endpoint (with filters: status, order)
    - [ ] Get single task endpoint
    - [ ] Create task endpoint
    - [ ] Update task endpoint (status, order, details)
    - [ ] Delete task endpoint (if needed)
  - [ ] Document endpoint paths, methods, request shapes, response shapes
  - [ ] Note that tasks are currently managed via SQLite/MCP (per frontend comments)
- [ ] Step 3: Inventory working directory files endpoints
  - [ ] Search backend codebase for file-related endpoints
  - [ ] Identify or document required endpoints:
    - [ ] Get file tree for repository/path
    - [ ] Get file contents (if needed for file viewer)
  - [ ] Document endpoint paths, methods, request shapes, response shapes
  - [ ] Note any authentication/authorization requirements
- [ ] Step 4: Inventory queue/worker status endpoints
  - [ ] Search backend codebase for queue/worker-related endpoints
  - [ ] Identify or document required endpoints:
    - [ ] Get queue status (active, waiting, failed jobs)
    - [ ] Get worker status (if applicable)
    - [ ] Get job details (if applicable)
  - [ ] Document endpoint paths, methods, request shapes, response shapes
  - [ ] Note polling requirements (if endpoints support real-time updates)
- [ ] Step 5: Document all findings
  - [ ] Create `python-converstion/backend-contracts.md`
  - [ ] For each endpoint category, document:
    - [ ] Endpoint path and HTTP method
    - [ ] Request parameters (path, query, body)
    - [ ] Request body shape (if applicable)
    - [ ] Response shape
    - [ ] Error responses
    - [ ] Authentication requirements
    - [ ] Whether endpoint exists or needs to be created
  - [ ] Create a gap analysis section:
    - [ ] List missing endpoints
    - [ ] Prioritize missing endpoints by importance
    - [ ] Note workarounds (if any) for missing endpoints

### Specific Requirements

- [ ] Requirement 1: Conversations endpoints
  - [ ] Document all endpoints needed for NoteTakingPanel functionality
  - [ ] Include request/response examples
  - [ ] Note any filtering, pagination, or sorting capabilities
- [ ] Requirement 2: Tasks endpoints
  - [ ] Document all endpoints needed for TaskManagementPanel functionality
  - [ ] Include request/response examples
  - [ ] Note status enum values and their meanings
  - [ ] Note order field behavior
- [ ] Requirement 3: Files endpoints
  - [ ] Document endpoints needed for WorkingDirectoryBrowser
  - [ ] Include request/response examples
  - [ ] Note repository/path parameter handling
- [ ] Requirement 4: Queues endpoints
  - [ ] Document endpoints needed for BullMQQueueView
  - [ ] Include request/response examples
  - [ ] Note polling or real-time update mechanisms

### Error Handling and Edge Cases

- [ ] Document expected error response formats
- [ ] Document error codes and their meanings
- [ ] Document handling of missing resources (404)
- [ ] Document handling of validation errors (400)
- [ ] Document handling of server errors (500)

### Testing

- [ ] No automated tests required for this task (documentation only)
- [ ] Verify documentation is accurate by cross-referencing with backend code
- [ ] Verify documentation is complete (all required endpoints documented)

### Documentation

- [ ] Create `python-converstion/backend-contracts.md`
- [ ] Organize by endpoint category (conversations, tasks, files, queues)
- [ ] Include code examples where helpful
- [ ] Include references to backend source files
- [ ] Create a summary table of endpoint status (exists/missing)

### Verification

- [ ] Verify all required endpoints are documented
- [ ] Verify documentation is accurate (matches backend code)
- [ ] Verify gap analysis is complete
- [ ] Verify documentation is clear and actionable

## Notes

- This task is part of the Task Dashboard React/TanStack Port project
- **Execution Timing**: Must be completed after TASK-TD-001 and TASK-TD-002, before implementation tasks
- **Dependencies**:
  - TASK-TD-001: Provides understanding of what endpoints are needed
  - TASK-TD-002: Provides understanding of API client patterns
- **Important Considerations**:
  - Focus on discovery, not implementation
  - Document both existing and missing endpoints
  - Note any workarounds or temporary solutions
  - Backend implementation of missing endpoints is out of scope
- **Task Independence**: Can be completed independently after dependencies
- **Current State**: Some endpoints exist (conversations), others may not (tasks, files, queues)

## Related Tasks

- Previous: TASK-TD-002
- Next: TASK-TD-004
- Dependencies:
  - TASK-TD-001: Provides endpoint requirements from baseline
  - TASK-TD-002: Provides API client patterns
- Related:
  - TASK-TD-006: Will use conversations endpoint documentation
  - TASK-TD-008: Will use files endpoint documentation
  - TASK-TD-010: Will use tasks endpoint documentation
  - TASK-TD-012: Will use queues endpoint documentation

## Definition of Done

### User Stories

**As a developer** implementing the Task Dashboard frontend, **I need** comprehensive documentation of required backend endpoints **so that** I know what APIs are available and what needs to be implemented.

**As a backend developer**, **I need** a clear list of missing endpoints **so that** I can prioritize and implement them.

### Automated Tests

- [ ] No automated tests required (documentation task)
- [ ] Documentation accuracy verified by cross-referencing with backend code

### Code Quality

- [ ] Backend contracts documentation file (`backend-contracts.md`) is created
- [ ] Documentation includes all required sections:
  - [ ] Conversations endpoints (complete)
  - [ ] Tasks endpoints (complete)
  - [ ] Files endpoints (complete)
  - [ ] Queues endpoints (complete)
  - [ ] Gap analysis (missing endpoints identified)
- [ ] All endpoint documentation includes:
  - [ ] Path and HTTP method
  - [ ] Request parameters and body shape
  - [ ] Response shape
  - [ ] Error responses
  - [ ] Existence status (exists/missing)
- [ ] Documentation is clear and actionable

### Git Commit and Push

- [ ] All changes are committed to git:
  - [ ] `python-converstion/backend-contracts.md` (if created)
  - [ ] Any other documentation files created
- [ ] Commit message follows project conventions: `"TASK-TD-003: Survey backend contracts needed for Task Dashboard"`
- [ ] Changes are pushed to origin: `git push origin <branch-name>`
- [ ] Verify push was successful: `git log --oneline -1` shows the commit

### Final Verification

- [ ] Backend contracts documentation exists and is complete
- [ ] All required endpoints are documented
- [ ] Gap analysis is complete
- [ ] Documentation is committed and pushed to origin
- [ ] Task is ready for handoff to TASK-TD-004

