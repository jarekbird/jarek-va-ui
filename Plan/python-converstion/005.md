# TASK-TD-005: Create TaskDashboard Shell Component

**Section**: 3. Route and Shell Setup
**Subsection**: 3.2
**Task ID**: TASK-TD-005
**Order**: 005

## Description

This task creates the TaskDashboard shell component that orchestrates the four main panels (file viewer, notes, tasks, queues). The shell manages state for conversation selection and coordinates cross-panel interactions via refs and callbacks. It implements the CSS grid layout matching the original TaskDashboard design.

**Reference Implementation**: 
- `VirtualAssistant/jarek-va-ui/src/components/TaskDashboard.tsx`
- `VirtualAssistant/jarek-va-ui/src/components/TaskDashboard.css`

## Current State

- Task Dashboard route exists (TASK-TD-004)
- TaskDashboardPage.tsx has placeholder content
- No TaskDashboard component exists yet
- No panel components exist yet (will be stubs for now)
- CSS grid layout needs to be implemented

**Important**: This task creates the shell with stub/placeholder children. Full panel implementations come in later tasks.

## Checklist

### Preparation and Setup

- [ ] Navigate to `python-cursor/cursor-executor/cursor-executor-front` directory
- [ ] Review reference implementation: `VirtualAssistant/jarek-va-ui/src/components/TaskDashboard.tsx`
- [ ] Review reference CSS: `VirtualAssistant/jarek-va-ui/src/components/TaskDashboard.css`
- [ ] Review baseline documentation from TASK-TD-001
- [ ] Decide on component location: `src/components/` or `src/routes/task-dashboard/components/`

### Implementation Steps

- [ ] Step 1: Create TaskDashboard component structure
  - [ ] Create `src/components/TaskDashboard.tsx` (or `src/routes/task-dashboard/components/TaskDashboard.tsx`)
  - [ ] Import React, useState, useRef
  - [ ] Create functional component `TaskDashboard`
  - [ ] Add state: `const [selectedNoteConversationId, setSelectedNoteConversationId] = useState<string | undefined>()`
  - [ ] Add refs: `const fileBrowserRef = useRef<WorkingDirectoryBrowserRef>(null)` and `const taskPanelRef = useRef<TaskManagementPanelRef>(null)`
  - [ ] Create `handleNoteConversationUpdate` callback:
    - [ ] Check if `fileBrowserRef.current?.refresh` exists, call it
    - [ ] Check if `taskPanelRef.current?.refresh` exists, call it
  - [ ] Add root container with `data-testid="task-dashboard"`
- [ ] Step 2: Create four panel regions
  - [ ] Create file viewer region: `<div className="task-dashboard__file-viewer">` with placeholder content
  - [ ] Create notes region: `<div className="task-dashboard__left">` with placeholder content
  - [ ] Create tasks region: `<div className="task-dashboard__middle-right">` with placeholder content
  - [ ] Create queues region: `<div className="task-dashboard__right">` with placeholder content
  - [ ] Add appropriate `data-testid` attributes to each region
- [ ] Step 3: Create TaskDashboard CSS
  - [ ] Create `src/components/TaskDashboard.css` (or matching location)
  - [ ] Port grid layout from reference CSS:
    - [ ] `.task-dashboard` container styles (flex, height, overflow)
    - [ ] `.task-dashboard__content` grid (4 columns: 250px 1fr 1fr 300px)
    - [ ] Panel region styles (`.task-dashboard__file-viewer`, `.task-dashboard__left`, `.task-dashboard__middle-right`, `.task-dashboard__right`)
  - [ ] Port responsive breakpoints:
    - [ ] Tablet view (max-width: 1400px) - 3 columns with queue at bottom
    - [ ] Mobile view (max-width: 768px) - single column stack
    - [ ] Small mobile (max-width: 480px) - spacing adjustments
  - [ ] Adapt to cursor-executor-front design system if needed
- [ ] Step 4: Create type definitions for refs
  - [ ] Create or update type file (e.g., `src/types/task-dashboard.ts`)
  - [ ] Define `WorkingDirectoryBrowserRef` interface with `refresh(): void` method
  - [ ] Define `TaskManagementPanelRef` interface with `refresh(): void` method
  - [ ] Export types for use in TaskDashboard
- [ ] Step 5: Integrate into TaskDashboardPage
  - [ ] Open `src/routes/task-dashboard/TaskDashboardPage.tsx`
  - [ ] Import `TaskDashboard` component
  - [ ] Import `TaskDashboard.css` (or ensure it's imported)
  - [ ] Replace placeholder content with `<TaskDashboard />`
  - [ ] Remove placeholder CSS if any

### Specific Requirements

- [ ] Requirement 1: Component structure
  - [ ] Component follows React functional component pattern
  - [ ] Component uses TypeScript with proper types
  - [ ] Component has proper prop types (if any props are needed)
  - [ ] Component exports correctly
- [ ] Requirement 2: State management
  - [ ] `selectedNoteConversationId` state is properly typed
  - [ ] Refs are properly typed with interfaces
  - [ ] State updates follow React best practices
- [ ] Requirement 3: Callback implementation
  - [ ] `handleNoteConversationUpdate` safely checks refs before calling
  - [ ] Callback is properly typed
  - [ ] Callback can be passed to child components
- [ ] Requirement 4: Layout implementation
  - [ ] CSS grid matches original layout structure
  - [ ] Responsive breakpoints match original behavior
  - [ ] Panel regions are properly sized and positioned

### Error Handling and Edge Cases

- [ ] Component handles missing refs gracefully (null checks)
- [ ] Component handles undefined conversation ID
- [ ] CSS handles edge cases (very small screens, very large screens)
- [ ] Component doesn't crash if child components are missing

### Testing

- [ ] Step 1: Create test file
  - [ ] Create `src/components/TaskDashboard.test.tsx` (or matching location)
  - [ ] Import React Testing Library utilities
  - [ ] Import component to test
- [ ] Step 2: Write rendering tests
  - [ ] Test: Component renders without crashing
  - [ ] Test: Component contains root container with `data-testid="task-dashboard"`
  - [ ] Test: Component renders all four panel regions
  - [ ] Test: Each panel region has appropriate `data-testid`
- [ ] Step 3: Write interaction tests
  - [ ] Test: `handleNoteConversationUpdate` calls `refresh` on fileBrowserRef when available
  - [ ] Test: `handleNoteConversationUpdate` calls `refresh` on taskPanelRef when available
  - [ ] Test: `handleNoteConversationUpdate` handles null refs gracefully
  - [ ] Use mocked refs with `jest.fn()` or `vi.fn()` (Vitest)
- [ ] Step 4: Write state tests
  - [ ] Test: `selectedNoteConversationId` state can be set
  - [ ] Test: State updates trigger re-renders appropriately
- [ ] Step 5: Run tests
  - [ ] Run: `npm test TaskDashboard`
  - [ ] Verify: All tests pass
  - [ ] Verify: Test coverage is adequate

### Documentation

- [ ] Add JSDoc comment to TaskDashboard component
  - [ ] Describe component purpose
  - [ ] Document props (if any)
  - [ ] Document state management
  - [ ] Document callback behavior
- [ ] Add comments to CSS explaining grid layout
- [ ] Document responsive breakpoints in CSS comments

### Verification

- [ ] Verify component renders in development
  - [ ] Run: `npm run dev`
  - [ ] Navigate to `/task-dashboard`
  - [ ] Verify: Four panel regions are visible
  - [ ] Verify: Layout matches original (grid structure)
- [ ] Verify responsive behavior
  - [ ] Test at different screen sizes
  - [ ] Verify: Layout adapts correctly
- [ ] Verify tests pass
- [ ] Verify no console errors or warnings

## Notes

- This task is part of the Task Dashboard React/TanStack Port project
- **Execution Timing**: Must be completed after TASK-TD-004, before panel implementation tasks
- **Dependencies**:
  - TASK-TD-004: Provides route structure
  - TASK-TD-001: Provides baseline reference
- **Important Considerations**:
  - Panel components are stubs/placeholders for now
  - Focus on shell structure and layout
  - CSS should match original as closely as possible
  - Refs and callbacks must work correctly for future integration
- **Task Independence**: Can be completed independently after TASK-TD-004
- **Current State**: Route exists but no dashboard component yet

## Related Tasks

- Previous: TASK-TD-004
- Next: TASK-TD-006
- Dependencies:
  - TASK-TD-004: Provides route structure
- Related:
  - TASK-TD-007: Will implement NoteTakingPanel to replace placeholder
  - TASK-TD-009: Will implement WorkingDirectoryBrowser to replace placeholder
  - TASK-TD-011: Will implement TaskManagementPanel to replace placeholder
  - TASK-TD-012: Will implement BullMQQueueView to replace placeholder

## Definition of Done

### User Stories

**As a developer**, **I need** a TaskDashboard shell component with proper layout **so that** I can see the four-panel structure and integrate panel components.

**As a user**, **I need** to see the Task Dashboard layout **so that** I can understand the interface structure even before all panels are functional.

### Automated Tests

- [ ] Component renders without crashing
  - [ ] Test file: `src/components/TaskDashboard.test.tsx`
  - [ ] Test: Renders root container with `data-testid="task-dashboard"`
  - [ ] Test: Renders all four panel regions
  - [ ] Run: `npm test TaskDashboard`
  - [ ] Verify: All rendering tests pass
- [ ] Callback functionality works
  - [ ] Test: `handleNoteConversationUpdate` calls refresh on refs
  - [ ] Test: Handles null refs gracefully
  - [ ] Verify: All callback tests pass
- [ ] State management works
  - [ ] Test: `selectedNoteConversationId` state can be managed
  - [ ] Verify: State tests pass
- [ ] All tests pass
  - [ ] Run: `npm test`
  - [ ] Verify: Exit code is 0, all tests pass
- [ ] Type checking passes
  - [ ] Run: `npm run type-check`
  - [ ] Verify: No type errors
- [ ] Linting passes
  - [ ] Run: `npm run lint`
  - [ ] Verify: No linting errors

### Code Quality

- [ ] TaskDashboard.tsx follows React best practices
- [ ] TaskDashboard.css matches original layout
- [ ] Component is properly typed (TypeScript)
- [ ] Refs are properly typed with interfaces
- [ ] Code follows project conventions

### Git Commit and Push

- [ ] All changes are committed to git:
  - [ ] `src/components/TaskDashboard.tsx` (new file)
  - [ ] `src/components/TaskDashboard.css` (new file)
  - [ ] `src/components/TaskDashboard.test.tsx` (new file)
  - [ ] `src/types/task-dashboard.ts` (new file, if created)
  - [ ] `src/routes/task-dashboard/TaskDashboardPage.tsx` (modified - integrates TaskDashboard)
- [ ] Commit message follows project conventions: `"TASK-TD-005: Create TaskDashboard shell component"`
- [ ] Changes are pushed to origin: `git push origin <branch-name>`
- [ ] Verify push was successful: `git log --oneline -1` shows the commit

### Final Verification

- [ ] TaskDashboard component exists and renders correctly
- [ ] Four panel regions are visible in correct layout
- [ ] CSS grid layout matches original design
- [ ] All tests pass
- [ ] Type checking passes
- [ ] Linting passes
- [ ] Code is committed and pushed to origin
- [ ] Task is ready for handoff to TASK-TD-006

