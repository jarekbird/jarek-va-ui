# TASK-34: Add accessibility checks

**Section**: 7. E2E, Accessibility, and Regression Tests (Phase 4)
**Subsection**: 7.3 Accessibility Testing
**Task ID**: TASK-34

## Description

This task adds accessibility (a11y) checks to the test suite to ensure the application meets WCAG accessibility standards. This includes both unit/integration level checks using jest-axe and E2E level checks using Playwright's accessibility snapshot or similar tools.

The tests will verify:
- No critical accessibility violations on core pages
- ARIA attributes are used correctly
- Semantic HTML is used correctly
- Keyboard navigation works
- Screen reader compatibility
- Color contrast meets standards
- Focus management works correctly

This ensures the application is accessible to users with disabilities.

## Current State

- No accessibility testing tools are currently installed or configured
- Application may or may not have accessibility issues
- No a11y tests currently exist
- Unit and integration tests may exist
- E2E tests may exist (from TASK-33)

**Reference Implementation**: 
- jest-axe documentation: https://github.com/nickcolley/jest-axe
- Playwright accessibility documentation: https://playwright.dev/docs/accessibility-testing
- WCAG guidelines: https://www.w3.org/WAI/WCAG21/quickref/

**Important**: This task should be executed after TASK-1, TASK-2, TASK-3, TASK-4, TASK-32, TASK-33 are complete (all unit tests, integration tests, and E2E framework setup).

## Checklist

### Preparation and Setup

- [ ] Review accessibility testing tools (jest-axe, Playwright a11y)
- [ ] Review WCAG guidelines
- [ ] Review application components for accessibility
- [ ] Understand accessibility requirements
- [ ] Review existing accessibility test patterns (if any)

### Implementation Steps

- [ ] Step 1: Install accessibility testing tools
  - [ ] Install jest-axe: `npm install --save-dev jest-axe`
  - [ ] Verify installation completes successfully
  - [ ] Install @axe-core/playwright (if using Playwright): `npm install --save-dev @axe-core/playwright`
  - [ ] Or install cypress-axe (if using Cypress): `npm install --save-dev cypress-axe`

- [ ] Step 2: Configure jest-axe for unit/integration tests
  - [ ] Import jest-axe in test setup or individual test files
  - [ ] Configure jest-axe with appropriate rules
  - [ ] Create helper function for a11y checks (if needed)
  - [ ] Document usage patterns

- [ ] Step 3: Write a11y tests for key components (unit/integration)
  - [ ] Test: Navigation component has no violations
  - [ ] Test: Dashboard component has no violations
  - [ ] Test: Main list views have no violations
  - [ ] Test: Main detail views have no violations
  - [ ] Test: Forms have no violations (if applicable)
  - [ ] Test: Buttons and interactive elements have proper labels

- [ ] Step 4: Configure E2E accessibility checks
  - [ ] Set up Playwright accessibility snapshot (if using Playwright)
  - [ ] Or set up Cypress a11y checks (if using Cypress)
  - [ ] Configure accessibility rules
  - [ ] Create helper functions for a11y checks

- [ ] Step 5: Write E2E a11y tests for core pages
  - [ ] Test: Conversation list page has no critical violations
  - [ ] Test: Conversation detail page has no critical violations
  - [ ] Test: Task list page has no critical violations
  - [ ] Test: Task detail page has no critical violations
  - [ ] Test: Task dashboard has no critical violations
  - [ ] Test: Agent conversation pages have no critical violations

- [ ] Step 6: Write tests for keyboard navigation
  - [ ] Test: All interactive elements are keyboard accessible
  - [ ] Test: Focus order is logical
  - [ ] Test: Focus indicators are visible
  - [ ] Test: Keyboard shortcuts work (if applicable)

- [ ] Step 7: Write tests for ARIA attributes
  - [ ] Test: ARIA labels are present where needed
  - [ ] Test: ARIA roles are correct
  - [ ] Test: ARIA states are correct
  - [ ] Test: ARIA live regions work (if applicable)

### Specific Requirements

- [ ] Requirement 1: Tools installed
  - jest-axe is installed
  - E2E a11y tools are installed
  - Installation completes successfully

- [ ] Requirement 2: Unit/integration a11y tests
  - Key components have a11y tests
  - Tests check for violations
  - Tests use jest-axe

- [ ] Requirement 3: E2E a11y tests
  - Core pages have a11y tests
  - Tests check for critical violations
  - Tests use E2E framework a11y tools

- [ ] Requirement 4: Keyboard navigation tested
  - Keyboard navigation works
  - Focus management works
  - Focus indicators are visible

### Error Handling and Edge Cases

- [ ] Handle case: Accessibility violations are found
  - Violations are reported clearly
  - Violations are documented
  - Fixes are prioritized

- [ ] Handle case: False positives in a11y checks
  - False positives are documented
  - Rules are adjusted if needed
  - Tests are still meaningful

### Testing

- [ ] Write all accessibility test cases
- [ ] Run unit/integration a11y tests: `npm test`
- [ ] Run E2E a11y tests: `npm run e2e`
- [ ] Verify all tests pass
- [ ] Fix any accessibility violations found
- [ ] Run type checking: `npm run type-check`
- [ ] Run linting: `npm run lint`

### Documentation

- [ ] Document accessibility testing approach
- [ ] Document how to run a11y tests
- [ ] Document accessibility standards followed
- [ ] Document any known issues or limitations

### Verification

- [ ] Verify accessibility testing tools are installed
- [ ] Verify a11y tests are written
- [ ] Verify tests pass
- [ ] Verify no critical violations exist
- [ ] Verify accessibility improvements are made

## Notes

- This task is part of Section 7: E2E, Accessibility, and Regression Tests (Phase 4)
- **Execution Timing**: Execute after TASK-1, TASK-2, TASK-3, TASK-4, TASK-32, TASK-33 are complete (all unit tests, integration tests, and E2E framework setup)
- **Dependencies**: 
  - TASK-1: Confirm local setup
  - TASK-2: Review existing test utilities
  - TASK-3: Introduce MSW (not required for a11y)
  - TASK-4: Configure coverage thresholds
  - TASK-32: Set up Playwright or Cypress for E2E (recommended for E2E a11y)
  - TASK-33: Implement core E2E journeys (recommended)
- **Important Considerations**: 
  - Focus on critical accessibility violations first
  - Use jest-axe for component-level checks
  - Use E2E framework a11y tools for page-level checks
  - Test keyboard navigation thoroughly
  - Test with screen readers if possible
  - Document accessibility standards followed
- **Task Independence**: Can be completed independently after prerequisites
- **Current State**: No accessibility testing tools are installed or configured

## Related Tasks

- Previous: TASK-33 (Implement core E2E journeys)
- Next: TASK-35 (Add visual regression tests)
- Dependencies:
  - TASK-1: Confirm local setup
  - TASK-2: Review existing test utilities
  - TASK-3: Introduce MSW (not required)
  - TASK-4: Configure coverage thresholds
  - TASK-32: Set up Playwright or Cypress for E2E (recommended)
  - TASK-33: Implement core E2E journeys (recommended)
- Related: TASK-33 (E2E tests), TASK-35 (visual regression tests)

## Definition of Done

### Task Type: TESTING TASK + CONFIGURATION TASK

**Description**: This task involves installing accessibility testing tools, configuring them, and writing accessibility tests.

**Definition of Done**: 

1. **Tools installed**:
   - jest-axe is installed
   - E2E a11y tools are installed (if applicable)
   - Installation completes successfully

2. **Configuration created**:
   - jest-axe is configured
   - E2E a11y tools are configured (if applicable)
   - Configuration is correct

3. **Tests written**:
   - Unit/integration a11y tests for key components
   - E2E a11y tests for core pages
   - Keyboard navigation tests
   - ARIA attribute tests

4. **Tests pass**:
   - All a11y tests pass
   - No critical accessibility violations
   - Full test suite passes: `npm test`
   - E2E a11y tests pass: `npm run e2e` (if applicable)

5. **Code quality**:
   - Tests use appropriate a11y tools
   - Tests are readable and maintainable
   - No linting errors
   - Type checking passes

6. **Code committed and pushed**:
   - Tool installations committed (package.json, package-lock.json)
   - Configuration files committed
   - Test files committed
   - Commit message: `feat: add accessibility checks with jest-axe and E2E a11y tools`
   - Code pushed to origin: `git push origin <branch-name>`

7. **User Story** (as a developer):
   - **As a** developer maintaining an accessible application
   - **I want** automated accessibility checks that verify WCAG compliance
   - **So that** I can ensure the application is accessible to all users

8. **Automated Tests**:
   - All a11y tests written and passing
   - No critical accessibility violations
   - Full test suite passes: `npm test` must complete successfully
   - Test verification: Run `npm test` and confirm all a11y tests pass

**Acceptance Criteria**:
- ✅ jest-axe installed and configured
- ✅ E2E a11y tools installed and configured (if applicable)
- ✅ A11y tests written for key components and pages
- ✅ All a11y tests pass
- ✅ No critical accessibility violations
- ✅ All changes committed and pushed to origin

**Tests are written, all tests pass, and test coverage meets project requirements**
