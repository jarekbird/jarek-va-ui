# TASK-3.1: Install MSW (Mock Service Worker) package

**Section**: 2. Testing Infrastructure Enhancements (Phase 1)
**Subsection**: 2.1
**Task ID**: TASK-3.1
**Parent Task**: TASK-3
**Order**: 1 of 4

## Description

This task installs the Mock Service Worker (MSW) package as a development dependency. MSW is a library that intercepts network requests at the service worker level, allowing us to mock API responses in tests without modifying application code.

This is the first step in setting up MSW for the test suite. Installing the package is a prerequisite for creating handlers, configuring the server, and integrating MSW into the test setup.

## Current State

- MSW is not currently installed
- `package.json` does not include `msw` in devDependencies
- No MSW-related files exist in the project
- Tests may be using manual fetch mocking or no mocking at all

**Reference Implementation**: 
- MSW documentation: https://mswjs.io/docs/
- `package.json` for dependency management

**Important**: This task should be executed after TASK-1 and TASK-2 are complete.

## Checklist

### Preparation and Setup

- [ ] Review MSW documentation to understand package requirements
- [ ] Check `package.json` for current dependencies
- [ ] Verify Node.js version compatibility (MSW requires Node.js 14+)
- [ ] Ensure npm is accessible and working

### Implementation Steps

- [ ] Step 1: Install MSW package
  - [ ] Run `npm install --save-dev msw` in the `virtual-assistant/jarek-va-ui` directory
  - [ ] Wait for installation to complete
  - [ ] Verify no installation errors occur

- [ ] Step 2: Verify installation
  - [ ] Check that `msw` is added to `package.json` devDependencies
  - [ ] Verify `msw` package exists in `node_modules/`
  - [ ] Verify `package-lock.json` is updated
  - [ ] Check installation output for any warnings

### Specific Requirements

- [ ] Requirement 1: MSW package installed
  - `msw` package is in `package.json` devDependencies
  - Package version is specified (e.g., `"msw": "^2.0.0"`)
  - Package is installed in `node_modules/`
  - No installation errors

- [ ] Requirement 2: Package files updated
  - `package.json` includes `msw` in devDependencies
  - `package-lock.json` is updated with MSW and its dependencies
  - All MSW dependencies are installed

### Error Handling and Edge Cases

- [ ] Handle case: MSW installation fails
  - Check Node.js version compatibility (MSW requires Node.js 14+)
  - Verify npm registry access
  - Check for dependency conflicts
  - Check disk space availability
  - Verify network connectivity

- [ ] Handle case: Package version conflicts
  - Review existing dependencies for conflicts
  - Resolve any peer dependency warnings
  - Update conflicting packages if necessary

- [ ] Handle case: Installation warnings
  - Review warnings for critical issues
  - Document any non-critical warnings
  - Verify MSW still functions despite warnings

### Testing

- [ ] Verify MSW can be imported
  - Create a simple test file that imports MSW
  - Verify no import errors occur
  - Run: `node -e "require('msw')"` to verify basic import

- [ ] Run type checking: `npm run type-check`
  - Verify no type errors related to MSW installation
  - Fix any TypeScript issues if they arise

### Documentation

- [ ] No documentation updates required for this installation step

### Verification

- [ ] Verify MSW is installed correctly
  - `msw` appears in `package.json` devDependencies
  - `node_modules/msw` directory exists
  - Package can be imported without errors

## Notes

- This task is part of **Section 2: Testing Infrastructure Enhancements (Phase 1)**
- **Execution Timing**: Execute after TASK-1 and TASK-2 are complete
- **Dependencies**: 
  - TASK-1: Confirm local setup (must be complete)
  - TASK-2: Review existing test utilities (must be complete)
- **Important Considerations**: 
  - MSW uses service workers in the browser, but for Node.js (Vitest), we use `msw/node`
  - Installation is straightforward and should complete without issues
  - This is a prerequisite for all subsequent MSW setup tasks
- **Task Independence**: Can be completed independently after prerequisites
- **Current State**: MSW is not installed

## Related Tasks

- Parent: TASK-3 (Introduce MSW for network mocking)
- Next: TASK-3.2 (Create mock handlers)
- Dependencies:
  - TASK-1: Confirm local setup
  - TASK-2: Review existing test utilities

## Definition of Done

### Task Type: SYSTEM/ENVIRONMENT OPERATION TASK

**Description**: This task involves installing the MSW package as a development dependency.

**Definition of Done**: 

1. **MSW installed**:
   - `msw` package added to `package.json` devDependencies
   - Package installed successfully in `node_modules/`
   - No installation errors

2. **Package files updated**:
   - `package.json` includes `msw` in devDependencies
   - `package-lock.json` is updated
   - All MSW dependencies are installed

3. **Installation verified**:
   - MSW can be imported without errors
   - Type checking passes (if applicable)
   - No critical warnings

4. **Code committed and pushed**:
   - `package.json` committed
   - `package-lock.json` committed
   - Commit message: `feat: install MSW for network mocking in tests`
   - Code pushed to origin: `git push origin <branch-name>`

5. **User Story** (as a developer):
   - **As a** developer setting up test infrastructure
   - **I want** MSW installed as a development dependency
   - **So that** I can use it to mock network requests in tests

6. **Automated Tests**:
   - No automated tests required for this installation task
   - Verification: Run `npm list msw` to confirm package is installed

**Acceptance Criteria**:
- ✅ `msw` package added to `package.json` devDependencies
- ✅ Package installed successfully in `node_modules/`
- ✅ No installation errors
- ✅ All changes committed and pushed to origin

**The required operation must complete successfully with no errors, and the expected artifacts must be created. If any part of the operation fails, the task is NOT complete.**















